---
import DocsLayout from '../../layouts/DocsLayout.astro';
import Callout from '../../components/Callout';
import CodeBlock from '../../components/CodeBlock';
import PageNavigation from '../../components/PageNavigation.astro';
---

<DocsLayout title="SPA 라우팅 기초" description="클라이언트 라우팅과 새로고침 404 문제의 원리" currentPath="/map/spa-routing">
  <div class="max-w-4xl mx-auto px-6 py-8">
    <h1 class="text-3xl font-black text-white mb-4">SPA 라우팅 기초</h1>
    <p class="text-text-secondary mb-6">React Router/Vue Router 사용 시 자주 만나는 새로고침 404를 원리부터 해결 방식까지 정리합니다.</p>

    <Callout client:load variant="tip" title="핵심 개념">
      <ul class="list-disc list-inside space-y-1 mt-2 text-sm">
        <li><strong>SPA</strong>: 브라우저에서 라우팅을 처리하는 단일 페이지 앱</li>
        <li><strong>Client-side Routing</strong>: JS 라우터가 경로를 바꿔 화면 전환</li>
        <li><strong>Fallback</strong>: 서버가 알 수 없는 경로를 <code>index.html</code>로 반환</li>
      </ul>
    </Callout>

    <article class="prose prose-invert max-w-none mt-8">
      <h2 class="text-2xl font-bold text-white mb-3">왜 새로고침에서 404가 날까?</h2>
      <p class="text-text-secondary mb-6">브라우저 새로고침은 서버에 현재 경로를 직접 요청합니다. 서버가 해당 파일을 모르면 404를 반환합니다.</p>

      <h2 class="text-2xl font-bold text-white mb-3">해결 방식</h2>
      <ol class="list-decimal list-inside text-text-secondary space-y-1 mb-6">
        <li>정적 파일이 없는 경로는 <code>index.html</code>로 fallback</li>
        <li>프론트 라우터가 경로를 받아 올바른 화면 렌더링</li>
      </ol>

      <h2 class="text-2xl font-bold text-white mb-3">Cloudflare Pages 예시</h2>
      <CodeBlock
        client:load
        filename="public/_redirects"
        code={`/* /index.html 200`}
      />

      <h2 class="text-2xl font-bold text-white mb-3">Nginx 예시</h2>
      <CodeBlock
        client:load
        filename="nginx.conf"
        code={`location / {
  try_files $uri $uri/ /index.html;
}`}
      />

      <h2 class="text-2xl font-bold text-white mb-3">60분 챌린지 연결 지점</h2>
      <ul class="list-disc list-inside text-text-secondary space-y-1 mb-6">
        <li><a href="/start/60min/deploy" class="text-primary hover:underline">배포 단계</a>: 라우팅 정책 반영</li>
        <li><a href="/fix/spa-404" class="text-primary hover:underline">SPA 404 트러블슈팅</a>: 플랫폼별 상세 설정</li>
      </ul>

      <h2 class="text-2xl font-bold text-white mb-3">초심자 실수 TOP 3</h2>
      <ul class="list-disc list-inside text-text-secondary space-y-1 mb-6">
        <li>로컬 개발 서버에서는 되는데 배포 서버 fallback 누락</li>
        <li>정적 파일 경로(<code>/assets</code>)까지 fallback에 걸어 리소스 깨짐</li>
        <li>서버 설정 수정 후 캐시 때문에 이전 동작만 확인</li>
      </ul>

      <Callout client:load variant="info" title="검증 체크리스트">
        <ul class="list-disc list-inside space-y-1 mt-2 text-sm">
          <li>직접 URL 입력 + 새로고침 시도</li>
          <li>개발자도구 Network에서 응답 코드 확인</li>
          <li>정적 파일(js/css)이 정상 200으로 내려오는지 확인</li>
        </ul>
      </Callout>
    </article>

    <PageNavigation currentPath="/map/spa-routing" />
  </div>
</DocsLayout>
