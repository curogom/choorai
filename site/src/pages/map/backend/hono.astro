---
import DocsLayout from '../../../layouts/DocsLayout.astro';
import Callout from '../../../components/Callout';
import CodeBlock from '../../../components/CodeBlock';
import PageNavigation from '../../../components/PageNavigation.astro';
---

<DocsLayout
  title="Hono - Lv.1 ì…ë¬¸ ë°±ì—”ë“œ"
  description="15ë¶„ ë§Œì— Node.js API ì„œë²„ ë§Œë“¤ê¸°"
  currentPath="/map/backend/hono"
>
  <div class="max-w-4xl mx-auto px-6 py-8">
    <nav class="flex items-center gap-2 text-sm text-text-secondary mb-6" aria-label="í˜„ì¬ ìœ„ì¹˜">
      <a href="/" class="hover:text-white transition-colors">í™ˆ</a>
      <span>/</span>
      <a href="/map/backend" class="hover:text-white transition-colors">Backend ë°°í¬</a>
      <span>/</span>
      <span class="text-primary font-medium">Hono</span>
    </nav>

    <header class="mb-8 pb-6 border-b border-border">
      <div class="flex items-center gap-2 mb-4">
        <span class="px-3 py-1 rounded-full bg-green-500/10 text-green-400 text-xs font-bold">Lv.1 ì…ë¬¸</span>
        <span class="px-3 py-1 rounded-full bg-surface text-text-secondary text-xs">Node.js</span>
        <span class="px-3 py-1 rounded-full bg-surface text-text-secondary text-xs">TypeScript</span>
      </div>
      <h1 class="text-3xl md:text-4xl font-black text-white mb-4">
        Honoë¡œ 15ë¶„ ë§Œì— API ë§Œë“¤ê¸°
      </h1>
      <p class="text-text-secondary text-lg leading-relaxed">
        HonoëŠ” ê°€ì¥ ê°€ë²¼ìš´ Node.js ì›¹ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.
        íŒŒì¼ í•˜ë‚˜ë¡œ ì™„ì „í•œ REST APIë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
    </header>

    <section class="mb-10">
      <Callout client:load variant="tip" title="ì™œ Honoì¸ê°€?">
        <ul class="list-disc list-inside space-y-1 mt-2">
          <li>Expressë³´ë‹¤ ë¹ ë¥´ê³  í˜„ëŒ€ì </li>
          <li>TypeScript ê¸°ë³¸ ì§€ì›</li>
          <li>Edge Runtime (Cloudflare Workers) í˜¸í™˜</li>
          <li>ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ê±°ì˜ ì—†ìŒ</li>
        </ul>
      </Callout>
    </section>

    <article class="prose prose-invert max-w-none">
      <!-- í”„ë¡œì íŠ¸ ìƒì„± -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">1. í”„ë¡œì íŠ¸ ìƒì„±</h2>

        <CodeBlock
          client:load
          code={`mkdir my-api && cd my-api
npm init -y
npm install hono @hono/node-server
npm install -D typescript @types/node tsx`}
          filename="í„°ë¯¸ë„"
        />

        <p class="text-text-secondary mt-4">
          <code class="bg-surface px-1 rounded">tsx</code>ëŠ” TypeScriptë¥¼ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
        </p>
      </section>

      <!-- ì²« API -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">2. ì²« API ì‘ì„±</h2>

        <CodeBlock
          client:load
          code={`import { Hono } from 'hono';
import { serve } from '@hono/node-server';

const app = new Hono();

// Health check
app.get('/health', (c) => {
  return c.json({
    status: 'ok',
    timestamp: new Date().toISOString(),
  });
});

// Hello API
app.get('/api/hello', (c) => {
  const name = c.req.query('name') || 'World';
  return c.json({ message: \`Hello, \${name}!\` });
});

// ì„œë²„ ì‹œì‘
serve({ fetch: app.fetch, port: 8000 });
console.log('ğŸš€ Server running on http://localhost:8000');`}
          filename="src/index.ts"
        />

        <h3 class="text-lg font-bold text-white mt-6 mb-3">ì‹¤í–‰</h3>

        <CodeBlock
          client:load
          code={`npx tsx src/index.ts

# í…ŒìŠ¤íŠ¸
curl http://localhost:8000/health
curl http://localhost:8000/api/hello?name=Choorai`}
          filename="í„°ë¯¸ë„"
        />
      </section>

      <!-- CRUD API -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">3. CRUD API ì¶”ê°€</h2>

        <CodeBlock
          client:load
          code={`import { Hono } from 'hono';
import { serve } from '@hono/node-server';
import { cors } from 'hono/cors';

const app = new Hono();

// CORS ì„¤ì •
app.use('*', cors({
  origin: ['http://localhost:5173'],
  credentials: true,
}));

// ì¸ë©”ëª¨ë¦¬ ì €ì¥ì†Œ
interface Project {
  id: string;
  name: string;
  description: string | null;
  created_at: string;
}

const projects = new Map<string, Project>();

// í”„ë¡œì íŠ¸ ëª©ë¡
app.get('/api/v1/projects', (c) => {
  const items = Array.from(projects.values());
  return c.json({ items, total: items.length });
});

// í”„ë¡œì íŠ¸ ìƒì„±
app.post('/api/v1/projects', async (c) => {
  const body = await c.req.json();
  const project: Project = {
    id: crypto.randomUUID(),
    name: body.name,
    description: body.description || null,
    created_at: new Date().toISOString(),
  };
  projects.set(project.id, project);
  return c.json(project, 201);
});

// í”„ë¡œì íŠ¸ ì¡°íšŒ
app.get('/api/v1/projects/:id', (c) => {
  const project = projects.get(c.req.param('id'));
  if (!project) return c.json({ error: 'Not found' }, 404);
  return c.json(project);
});

// í”„ë¡œì íŠ¸ ì‚­ì œ
app.delete('/api/v1/projects/:id', (c) => {
  const deleted = projects.delete(c.req.param('id'));
  if (!deleted) return c.json({ error: 'Not found' }, 404);
  return c.body(null, 204);
});

serve({ fetch: app.fetch, port: 8000 });
console.log('ğŸš€ Server running on http://localhost:8000');`}
          filename="src/index.ts"
        />
      </section>

      <!-- Docker ë°°í¬ -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">4. Dockerë¡œ ë°°í¬</h2>

        <CodeBlock
          client:load
          code={`FROM node:20-slim
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run build
EXPOSE 8000
CMD ["node", "dist/index.js"]`}
          filename="Dockerfile"
        />

        <CodeBlock
          client:load
          code={`# ë¡œì»¬ í…ŒìŠ¤íŠ¸
docker build -t my-hono-api .
docker run -p 8000:8000 my-hono-api

# Cloud Run ë°°í¬
gcloud builds submit --tag gcr.io/YOUR_PROJECT/my-hono-api
gcloud run deploy my-hono-api --image gcr.io/YOUR_PROJECT/my-hono-api`}
          filename="í„°ë¯¸ë„"
        />
      </section>

      <!-- ë¹„êµ -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">FastAPI vs Hono</h2>

        <div class="grid md:grid-cols-2 gap-4">
          <div class="p-4 bg-surface border border-border rounded-xl">
            <h3 class="text-white font-bold mb-2">Hono (ì´ í˜ì´ì§€)</h3>
            <ul class="text-text-secondary text-sm space-y-1">
              <li>âœ… JavaScript/TypeScript í†µì¼</li>
              <li>âœ… í”„ë¡ íŠ¸ì—”ë“œì™€ ê°™ì€ ì–¸ì–´</li>
              <li>âœ… Edge Runtime ì§€ì›</li>
              <li>âš ï¸ íƒ€ì… ê²€ì¦ ì§ì ‘ êµ¬í˜„</li>
            </ul>
          </div>
          <div class="p-4 bg-surface border border-border rounded-xl">
            <h3 class="text-white font-bold mb-2">FastAPI (Lv.2)</h3>
            <ul class="text-text-secondary text-sm space-y-1">
              <li>âœ… ìë™ ë¬¸ì„œí™” (Swagger)</li>
              <li>âœ… Pydantic íƒ€ì… ê²€ì¦</li>
              <li>âœ… Python ìƒíƒœê³„ (ML/AI)</li>
              <li>âš ï¸ ë³„ë„ ì–¸ì–´ í•™ìŠµ í•„ìš”</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- ì˜ˆì œ ì½”ë“œ -->
      <section class="mb-10">
        <Callout client:load variant="info" title="ì „ì²´ ì˜ˆì œ ì½”ë“œ">
          <p class="text-sm mt-2">
            B2B Admin APIì˜ Hono ë²„ì „ì„ í™•ì¸í•˜ì„¸ìš”:
            <a href="https://github.com/curogom/choorai/tree/main/examples/b2b-admin/api-hono" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline ml-1">
              examples/b2b-admin/api-hono
            </a>
          </p>
        </Callout>
      </section>
    </article>

    <PageNavigation currentPath="/map/backend/hono" />
  </div>
</DocsLayout>
