---
import DocsLayout from '../../layouts/DocsLayout.astro';
import Callout from '../../components/Callout';
import CodeBlock from '../../components/CodeBlock';
import PageNavigation from '../../components/PageNavigation.astro';
---

<DocsLayout
  title="Cycle 1: DNS - 도메인 기초"
  description="도메인과 DNS의 기초를 이해하고 커스텀 도메인을 연결하는 방법"
  currentPath="/map/dns"
>
  <div class="max-w-4xl mx-auto px-6 py-8">
    <nav class="flex items-center gap-2 text-sm text-text-secondary mb-6" aria-label="현재 위치">
      <a href="/" class="hover:text-white transition-colors">홈</a>
      <span>/</span>
      <a href="/map" class="hover:text-white transition-colors">학습 사이클</a>
      <span>/</span>
      <span class="text-primary font-medium">Cycle 1: DNS</span>
    </nav>

    <header class="mb-8 pb-6 border-b border-border">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold mb-4">
        Cycle 1
      </div>
      <h1 class="text-3xl md:text-4xl font-black text-white mb-4">
        도메인과 DNS 기초
      </h1>
      <p class="text-text-secondary text-lg leading-relaxed">
        <code class="bg-surface px-1 rounded">192.168.1.1</code> 같은 IP 주소 대신
        <code class="bg-surface px-1 rounded">myapp.com</code> 같은 도메인을 사용하는 방법을 배웁니다.
      </p>
    </header>

    <section class="mb-10">
      <Callout client:load variant="tip" title="이 Cycle에서 배우는 것">
        <ul class="list-disc list-inside space-y-1 mt-2">
          <li>URL 구조 이해하기</li>
          <li>DNS 레코드 종류 (A, CNAME, TXT)</li>
          <li>도메인 구매처 비교</li>
          <li>Cloudflare로 도메인 연결하기</li>
        </ul>
      </Callout>
    </section>

    <article class="prose prose-invert max-w-none">
      <!-- 도메인이란? -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">도메인이란?</h2>

        <p class="text-text-secondary mb-4">
          도메인은 IP 주소에 붙이는 <strong class="text-white">사람이 읽을 수 있는 이름</strong>입니다.
        </p>

        <div class="grid md:grid-cols-2 gap-4 mb-6">
          <div class="p-4 bg-red-500/10 border border-red-500/30 rounded-xl">
            <h3 class="text-white font-bold mb-2">IP 주소 (어려움)</h3>
            <code class="text-red-400 text-lg">142.250.207.14</code>
            <p class="text-text-secondary text-sm mt-2">외우기 어렵고, 서버가 바뀌면 변경됨</p>
          </div>
          <div class="p-4 bg-green-500/10 border border-green-500/30 rounded-xl">
            <h3 class="text-white font-bold mb-2">도메인 (쉬움)</h3>
            <code class="text-green-400 text-lg">google.com</code>
            <p class="text-text-secondary text-sm mt-2">외우기 쉽고, IP가 바뀌어도 동일</p>
          </div>
        </div>

        <h3 class="text-lg font-bold text-white mt-6 mb-3">URL 구조 분해</h3>

        <div class="bg-surface border border-border rounded-xl p-6 mb-4">
          <div class="font-mono text-sm md:text-base overflow-x-auto">
            <span class="text-blue-400">https://</span><span class="text-yellow-400">api</span>.<span class="text-green-400">myapp</span>.<span class="text-purple-400">com</span><span class="text-orange-400">:8080</span><span class="text-pink-400">/users</span><span class="text-gray-400">?page=1</span>
          </div>
          <div class="grid grid-cols-2 md:grid-cols-3 gap-2 mt-4 text-sm">
            <div><span class="text-blue-400">https://</span> <span class="text-text-secondary">프로토콜</span></div>
            <div><span class="text-yellow-400">api</span> <span class="text-text-secondary">서브도메인</span></div>
            <div><span class="text-green-400">myapp</span> <span class="text-text-secondary">도메인</span></div>
            <div><span class="text-purple-400">com</span> <span class="text-text-secondary">TLD</span></div>
            <div><span class="text-orange-400">:8080</span> <span class="text-text-secondary">포트</span></div>
            <div><span class="text-pink-400">/users</span> <span class="text-text-secondary">경로</span></div>
          </div>
        </div>
      </section>

      <!-- DNS 레코드 종류 -->
      <section class="mb-10">
        <Callout client:load variant="info" title="초심자용 실전 체크리스트">
          <ol class="list-decimal list-inside space-y-1 mt-2 text-sm">
            <li>도메인을 먼저 구매하거나 무료 서브도메인을 선택합니다.</li>
            <li>Cloudflare에서 DNS 레코드를 추가합니다.</li>
            <li>적용까지 수 분~수 시간 전파 지연이 있을 수 있습니다.</li>
            <li>접속 안 되면 DNS 값, 프록시 상태, 캐시를 순서대로 확인합니다.</li>
          </ol>
        </Callout>

        <h2 class="text-2xl font-bold text-white mb-4">DNS 레코드 종류</h2>

        <p class="text-text-secondary mb-4">
          DNS(Domain Name System)는 도메인을 IP 주소로 변환하는 시스템입니다.
          여러 종류의 레코드가 있습니다:
        </p>

        <div class="space-y-4">
          <div class="p-4 bg-surface border border-border rounded-xl">
            <div class="flex items-center gap-2 mb-2">
              <span class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs font-bold">A</span>
              <h3 class="text-white font-bold">Address Record</h3>
            </div>
            <p class="text-text-secondary text-sm mb-2">도메인을 IPv4 주소로 연결합니다.</p>
            <CodeBlock
              client:load
              code={`myapp.com → 192.168.1.1`}
              filename="예시"
            />
          </div>

          <div class="p-4 bg-surface border border-border rounded-xl">
            <div class="flex items-center gap-2 mb-2">
              <span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs font-bold">CNAME</span>
              <h3 class="text-white font-bold">Canonical Name</h3>
            </div>
            <p class="text-text-secondary text-sm mb-2">도메인을 다른 도메인으로 연결합니다. (별칭)</p>
            <CodeBlock
              client:load
              code={`www.myapp.com → myapp.com
api.myapp.com → myapp.pages.dev`}
              filename="예시"
            />
          </div>

          <div class="p-4 bg-surface border border-border rounded-xl">
            <div class="flex items-center gap-2 mb-2">
              <span class="px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs font-bold">TXT</span>
              <h3 class="text-white font-bold">Text Record</h3>
            </div>
            <p class="text-text-secondary text-sm mb-2">텍스트 정보를 저장합니다. 주로 도메인 소유권 인증에 사용됩니다.</p>
            <CodeBlock
              client:load
              code={`_verification.myapp.com → "google-site-verification=abc123"`}
              filename="예시"
            />
          </div>
        </div>
      </section>

      <!-- 도메인 구매처 -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">도메인 구매처 비교</h2>

        <div class="grid md:grid-cols-3 gap-4 mb-6">
          <a href="https://www.cloudflare.com/products/registrar/" target="_blank" rel="noopener noreferrer" class="p-4 bg-surface border border-primary/50 rounded-xl hover:border-primary transition-colors no-underline">
            <div class="flex items-center gap-2 mb-2">
              <span class="px-2 py-0.5 rounded bg-primary/20 text-primary text-xs font-bold">추천</span>
              <h3 class="text-white font-bold">Cloudflare</h3>
            </div>
            <p class="text-text-secondary text-sm mb-2">원가 판매, 무료 DNS/CDN 포함</p>
            <span class="text-primary text-sm">registrar.cloudflare.com →</span>
          </a>

          <a href="https://www.namecheap.com" target="_blank" rel="noopener noreferrer" class="p-4 bg-surface border border-border rounded-xl hover:border-primary/50 transition-colors no-underline">
            <h3 class="text-white font-bold mb-2">Namecheap</h3>
            <p class="text-text-secondary text-sm mb-2">다양한 TLD, 합리적 가격</p>
            <span class="text-primary text-sm">namecheap.com →</span>
          </a>

          <a href="https://www.gabia.com" target="_blank" rel="noopener noreferrer" class="p-4 bg-surface border border-border rounded-xl hover:border-primary/50 transition-colors no-underline">
            <h3 class="text-white font-bold mb-2">가비아</h3>
            <p class="text-text-secondary text-sm mb-2">한국어 지원, .kr 도메인</p>
            <span class="text-primary text-sm">gabia.com →</span>
          </a>
        </div>

        <Callout client:load variant="tip" title="무료 도메인?">
          <p class="mt-2 text-sm">
            Cloudflare Pages, Vercel, Netlify 등은 무료 서브도메인을 제공합니다.
            예: <code class="bg-surface px-1 rounded">myapp.pages.dev</code>
            처음 시작할 때는 이것으로 충분합니다.
          </p>
        </Callout>
      </section>

      <!-- 실습 -->
      <section class="mb-10">
        <h2 class="text-2xl font-bold text-white mb-4">실습: Cloudflare로 도메인 연결</h2>

        <div class="space-y-6">
          <div class="p-4 bg-surface border border-border rounded-xl">
            <h3 class="text-white font-bold mb-3">1. 네임서버 변경</h3>
            <p class="text-text-secondary text-sm mb-3">
              도메인 구매처에서 네임서버를 Cloudflare로 변경합니다.
            </p>
            <CodeBlock
              client:load
              code={`# Cloudflare 네임서버 예시
ns1.cloudflare.com
ns2.cloudflare.com`}
              filename="네임서버 설정"
            />
          </div>

          <div class="p-4 bg-surface border border-border rounded-xl">
            <h3 class="text-white font-bold mb-3">2. DNS 레코드 추가</h3>
            <p class="text-text-secondary text-sm mb-3">
              Cloudflare 대시보드에서 DNS 레코드를 추가합니다.
            </p>
            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-border">
                    <th class="text-left py-2 px-3 text-white">타입</th>
                    <th class="text-left py-2 px-3 text-white">이름</th>
                    <th class="text-left py-2 px-3 text-white">값</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-b border-border/50">
                    <td class="py-2 px-3"><span class="text-blue-400">CNAME</span></td>
                    <td class="py-2 px-3 text-text-secondary">@</td>
                    <td class="py-2 px-3 text-text-secondary">myapp.pages.dev</td>
                  </tr>
                  <tr class="border-b border-border/50">
                    <td class="py-2 px-3"><span class="text-blue-400">CNAME</span></td>
                    <td class="py-2 px-3 text-text-secondary">www</td>
                    <td class="py-2 px-3 text-text-secondary">myapp.pages.dev</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="p-4 bg-surface border border-border rounded-xl">
            <h3 class="text-white font-bold mb-3">3. SSL/TLS 설정</h3>
            <p class="text-text-secondary text-sm">
              Cloudflare에서 SSL/TLS 암호화를 <strong class="text-white">"Full (strict)"</strong>로 설정합니다.
              HTTPS가 자동으로 활성화됩니다.
            </p>
          </div>
        </div>
      </section>

      <!-- 다음 단계 -->
      <section class="mb-10">
        <Callout client:load variant="info" title="다음 단계">
          <p class="text-sm">
            도메인 설정이 완료되었다면, 이제 프론트엔드 앱을 배포해봅시다.
            <a href="/map/frontend" class="text-primary hover:underline ml-1">Cycle 2: Frontend 배포</a>에서
            React 앱을 Cloudflare Pages에 배포하는 방법을 배웁니다.
          </p>
        </Callout>
      </section>
    </article>

    <PageNavigation currentPath="/map/dns" />
  </div>
</DocsLayout>
