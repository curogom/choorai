---
import DocsLayout from '../../../layouts/DocsLayout.astro';
import ErrorCard from '../../../components/ErrorCard';
import CodeBlock from '../../../components/CodeBlock';
import Callout from '../../../components/Callout';
import TroubleshootingTemplate from '../../../components/TroubleshootingTemplate.astro';

const faqStructuredData = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    {
      '@type': 'Question',
      name: 'Why does DNS_PROBE_FINISHED_NXDOMAIN happen?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'It occurs when DNS cannot find records for the requested domain, often due to missing records, typos, or wrong nameserver settings.',
      },
    },
    {
      '@type': 'Question',
      name: 'What should I check first?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Verify domain spelling, confirm A/CNAME records exist in DNS provider, and query public DNS with dig to confirm propagation.',
      },
    },
  ],
};
---

<DocsLayout
  lang="en"
  title="Fixing DNS NXDOMAIN Errors"
  description="How to fix DNS_PROBE_FINISHED_NXDOMAIN"
  currentPath="/fix/dns-nxdomain"
  structuredData={[faqStructuredData]}
>
  <div class="max-w-4xl mx-auto px-6 py-8">
    <nav class="flex items-center gap-2 text-sm text-text-secondary mb-6" aria-label="Breadcrumb">
      <a href="/en" class="hover:text-white transition-colors">Home</a>
      <span>/</span>
      <a href="/en/fix" class="hover:text-white transition-colors">Troubleshooting</a>
      <span>/</span>
      <span class="text-primary font-medium">DNS NXDOMAIN</span>
    </nav>

    <header class="mb-8 pb-6 border-b border-border">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-error/10 text-error text-xs font-bold mb-4">
        Common after initial deployment
      </div>
      <h1 class="text-3xl md:text-4xl font-black text-white mb-4">
        Fixing DNS NXDOMAIN Errors
      </h1>
      <p class="text-text-secondary text-lg leading-relaxed">
        Seeing <code class="bg-surface px-1 rounded">DNS_PROBE_FINISHED_NXDOMAIN</code> in browser?
        DNS records may be missing or not fully propagated yet.
      </p>
    </header>

    <section class="mb-8">
      <Callout client:load locale="en" variant="tip" title="TL;DR">
        <p class="mt-2">
          1) Check domain typos
          2) Verify A/CNAME records
          3) Run <code class="bg-surface px-1 rounded">dig</code> against public resolvers
          4) Wait for TTL propagation
        </p>
      </Callout>
    </section>

    <section class="mb-8 space-y-6">
      <ErrorCard
        client:load
        errorMessage="DNS_PROBE_FINISHED_NXDOMAIN"
        severity="critical"
        cause="DNS cannot resolve the requested host. Common causes are missing records, typo in host, or incorrect nameserver delegation."
        solution={[
          "Verify domain and subdomain spelling",
          "Confirm A/CNAME records exist",
          "Check registrar nameserver delegation",
          "Allow propagation time based on TTL"
        ]}
        aiPrompt="I see DNS_PROBE_FINISHED_NXDOMAIN on my domain. I use Cloudflare DNS. Give me a step-by-step debug checklist."
      />
    </section>

    <article class="prose prose-invert max-w-none">
      <h2 class="text-2xl font-bold text-white mb-4">Diagnostic steps</h2>

      <section class="mb-8">
        <CodeBlock
          client:load
          filename="terminal"
          code={`dig your-domain.com

dig @1.1.1.1 your-domain.com

dig @8.8.8.8 your-domain.com`}
        />
      </section>

      <section class="mb-8">
        <h3 class="text-xl font-bold text-white mb-3">Cloudflare record example</h3>
        <CodeBlock
          client:load
          filename="DNS records"
          code={`Type    Name    Content             Proxy
A       @       203.0.113.10        DNS only
CNAME   www     your-domain.com      Proxied`}
        />
      </section>

      <section class="mb-8">
        <Callout client:load locale="en" variant="warning" title="Important">
          <p class="mt-2">
            Avoid conflicting records and remember DNS propagation may take time depending on TTL and resolver cache.
          </p>
        </Callout>
      </section>
    </article>

    <TroubleshootingTemplate topic="dns-nxdomain" lang="en" />

    <section class="mt-12 pt-8 border-t border-border">
      <h3 class="text-lg font-bold text-white mb-4">Related Articles</h3>
      <div class="grid md:grid-cols-2 gap-4">
        <a href="/en/map/dns" class="p-4 bg-surface border border-border rounded-lg hover:border-primary/50 transition-colors no-underline">
          <h4 class="text-white font-medium mb-1">Domain & DNS</h4>
          <p class="text-text-secondary text-sm">Core DNS concepts</p>
        </a>
        <a href="/en/fix/ssl-cert" class="p-4 bg-surface border border-border rounded-lg hover:border-primary/50 transition-colors no-underline">
          <h4 class="text-white font-medium mb-1">SSL Certificate Error</h4>
          <p class="text-text-secondary text-sm">HTTPS/TLS issues</p>
        </a>
      </div>
    </section>
  </div>
</DocsLayout>
