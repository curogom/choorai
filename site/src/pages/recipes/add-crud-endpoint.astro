---
import DocsLayout from '../../layouts/DocsLayout.astro';
import Callout from '../../components/Callout';
import CodeBlock from '../../components/CodeBlock';
import PromptBox from '../../components/PromptBox';
import Checklist from '../../components/Checklist';

const prompt = `기존 서비스에 CRUD 엔드포인트를 추가하려고 해.
아래 조건으로 구현 계획 + 코드 초안을 만들어줘.

[입력 정보]
- 리소스 이름: [RESOURCE]
- 필드 정의: [FIELDS]
- 백엔드 스택: [FastAPI/Hono/Nest]
- 저장소: [RDB/NoSQL/in-memory]
- 인증 필요 여부: [true/false]

[출력 요구사항]
1) 라우트/DTO/검증 구조
2) Create/Read/Update/Delete API 설계
3) 에러 처리/상태코드 규칙
4) 테스트 케이스 최소 5개
5) 프론트 연동 체크리스트`;

const checklist = [
  { id: 'schema', label: '스키마 정의', description: '필드/검증/기본값 확정' },
  { id: 'routes', label: 'CRUD 라우트 구현', description: 'C/R/U/D 전체 API 추가' },
  { id: 'errors', label: '예외 처리 정리', description: '400/404/409/500 응답 규칙 점검' },
  { id: 'tests', label: '테스트 작성', description: '단위/통합 최소 케이스 추가' },
  { id: 'integration', label: '프론트 연동 확인', description: '요청/응답 타입 일치 검증' },
];
---

<DocsLayout
  title="레시피: CRUD 엔드포인트 추가"
  description="기존 서비스에 CRUD API를 안정적으로 추가하는 프롬프트 레시피"
  currentPath="/recipes/add-crud-endpoint"
>
  <div class="max-w-4xl mx-auto px-6 py-8">
    <nav class="flex items-center gap-2 text-sm text-text-secondary mb-6" aria-label="현재 위치">
      <a href="/" class="hover:text-white transition-colors">홈</a>
      <span>/</span>
      <a href="/recipes" class="hover:text-white transition-colors">Recipes</a>
      <span>/</span>
      <span class="text-primary font-medium">CRUD 엔드포인트 추가</span>
    </nav>

    <header class="mb-8 pb-6 border-b border-border">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-purple-500/10 text-purple-300 text-xs font-bold mb-4">
        Recipes Core Pack · API
      </div>
      <h1 class="text-3xl md:text-4xl font-black text-white mb-4">CRUD 엔드포인트 추가</h1>
      <p class="text-text-secondary text-lg leading-relaxed">
        데이터 모델 정의부터 테스트까지, CRUD 기능 추가 시 필요한 작업을 빠르게 정리합니다.
      </p>
    </header>

    <section class="mb-8">
      <Callout client:load variant="tip" title="추천 사용 시점">
        <p class="mt-2">새 도메인 모델 추가, 백오피스 API 확장, MVP 기능 확장 시점에 활용하세요.</p>
      </Callout>
    </section>

    <section class="mb-10">
      <PromptBox client:load prompt={prompt} title="CRUD 엔드포인트 프롬프트" />
    </section>

    <section class="mb-10">
      <h2 class="text-2xl font-bold text-white mb-4">응답 규칙 예시</h2>
      <CodeBlock
        client:load
        filename="http"
        code={`POST /api/v1/projects -> 201 Created
GET /api/v1/projects/{id} -> 200 OK
PATCH /api/v1/projects/{id} -> 200 OK
DELETE /api/v1/projects/{id} -> 204 No Content
GET /api/v1/projects/{missing} -> 404 Not Found`}
      />
    </section>

    <section class="mb-10">
      <Checklist client:load storageKey="recipe-add-crud-endpoint" title="실행 체크리스트" items={checklist} />
    </section>

    <section class="mt-12 pt-8 border-t border-border">
      <h3 class="text-lg font-bold text-white mb-4">관련 문서</h3>
      <div class="grid md:grid-cols-2 gap-4">
        <a href="/map/database/rdb" class="p-4 bg-surface border border-border rounded-lg hover:border-primary/50 transition-colors no-underline">
          <h4 class="text-white font-medium mb-1">RDB 설계 기본</h4>
          <p class="text-text-secondary text-sm">테이블/관계/쿼리 구조</p>
        </a>
        <a href="/fix/failed-to-fetch" class="p-4 bg-surface border border-border rounded-lg hover:border-primary/50 transition-colors no-underline">
          <h4 class="text-white font-medium mb-1">Failed to fetch</h4>
          <p class="text-text-secondary text-sm">연동 중 네트워크/경로 점검</p>
        </a>
      </div>
    </section>
  </div>
</DocsLayout>
