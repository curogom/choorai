---
import DocsLayout from '../../layouts/DocsLayout.astro';
import Callout from '../../components/Callout';
import PageNavigation from '../../components/PageNavigation.astro';

const recipes = [
  {
    id: 1,
    category: '프로젝트 시작',
    title: 'React 프로젝트 생성',
    description: 'Vite + React + TypeScript + Tailwind 스택으로 새 프로젝트 시작',
    prompt: 'Vite + React + TypeScript + Tailwind로 새 프로젝트를 만들어줘. ESLint, Prettier 설정도 포함하고, 폴더 구조는 feature-based로 해줘.',
    tags: ['React', 'Vite', 'TypeScript'],
  },
  {
    id: 2,
    category: '프로젝트 시작',
    title: 'FastAPI 보일러플레이트',
    description: 'Python FastAPI 백엔드 프로젝트 초기 설정',
    prompt: 'FastAPI 프로젝트를 만들어줘. SQLAlchemy, Alembic, Pydantic 설정 포함. /health 엔드포인트와 기본 CORS 설정도 추가해줘.',
    tags: ['FastAPI', 'Python', 'SQLAlchemy'],
  },
  {
    id: 3,
    category: '프로젝트 시작',
    title: '프로젝트 구조 설계',
    description: '요구사항에 맞는 프로젝트 아키텍처 설계',
    prompt: '이 요구사항으로 프로젝트 구조를 설계해줘: [요구사항을 여기에 입력]. 폴더 구조, 기술 스택, 데이터 모델을 제안해줘.',
    tags: ['아키텍처', '설계'],
  },
  {
    id: 4,
    category: '개발',
    title: '컴포넌트 생성',
    description: 'React 컴포넌트를 Props 타입과 함께 생성',
    prompt: '[기능 설명] 컴포넌트를 만들어줘. Props 타입 정의, 반응형 디자인, 접근성(a11y) 고려해줘.',
    tags: ['React', '컴포넌트', 'TypeScript'],
  },
  {
    id: 5,
    category: '개발',
    title: 'API 엔드포인트 추가',
    description: 'CRUD API 엔드포인트 생성',
    prompt: '[리소스 이름]의 CRUD API를 만들어줘. Pydantic 스키마, 에러 핸들링, 페이지네이션 포함해줘.',
    tags: ['FastAPI', 'REST API', 'CRUD'],
  },
  {
    id: 6,
    category: '개발',
    title: '빌드 실패 진단',
    description: '빌드 로그를 분석해서 원인 우선순위를 정리',
    prompt: '아래 빌드 로그를 분석해줘: [빌드 로그]. 가능한 원인 Top3와 각 원인의 검증 방법, 즉시 적용할 수정안, 재발 방지 체크리스트를 표로 정리해줘.',
    tags: ['디버깅', '빌드', '트러블슈팅'],
    href: '/recipes/debug-build-fail',
  },
  {
    id: 7,
    category: '개발',
    title: 'TypeScript 타입 정의',
    description: 'API 응답에 맞는 타입 생성',
    prompt: '이 API 응답에 맞는 TypeScript 타입을 정의해줘: [JSON 응답을 여기에 붙여넣기]. 재사용 가능한 유틸리티 타입도 만들어줘.',
    tags: ['TypeScript', '타입'],
  },
  {
    id: 8,
    category: '배포',
    title: 'Cloudflare Pages 배포',
    description: 'React/Vite 앱 배포 + SPA 리라이트 + 도메인 연결',
    prompt: 'React/Vite 프로젝트를 Cloudflare Pages에 배포하려고 해. GitHub 연결부터 build 설정, _redirects(SPA), 환경변수, 커스텀 도메인 연결까지 단계별 실행 가이드를 만들어줘.',
    tags: ['Cloudflare', '배포', 'Frontend', 'SPA'],
    href: '/recipes/deploy-cloudflare-pages',
  },
  {
    id: 9,
    category: '배포',
    title: 'Cloud Run 배포',
    description: 'FastAPI 앱을 Cloud Run에 배포 + 기본 운영 설정',
    prompt: 'FastAPI 프로젝트를 Cloud Run에 배포하려고 해. Dockerfile 작성, gcloud 배포 명령, 환경변수 설정, 최소 운영 체크(max instances, health endpoint)를 포함한 실행 절차를 알려줘.',
    tags: ['Cloud Run', '배포', 'Docker', 'FastAPI'],
    href: '/recipes/deploy-cloud-run',
  },
  {
    id: 10,
    category: '배포',
    title: '환경변수 일괄 점검',
    description: '개발/스테이징/프로덕션 환경변수 매트릭스 정리',
    prompt: '이 프로젝트의 환경변수를 점검해줘. 로컬(.env), CI/CD, 배포 플랫폼 환경변수를 비교해서 누락/오탈자/보안 위험을 표로 정리하고, .env.example 초안을 만들어줘.',
    tags: ['환경변수', 'DevOps', '보안'],
    href: '/recipes/check-env-vars',
  },
  {
    id: 11,
    category: '프로젝트 시작',
    title: 'React 프로젝트 부트스트랩',
    description: 'Vite 기반 React 프로젝트를 빠르게 시작하는 초기화 레시피',
    prompt: '새 React 프로젝트를 시작하려고 해. Vite + TypeScript + ESLint/Prettier + feature-based 구조까지 포함한 실행 절차를 만들어줘.',
    tags: ['React', 'Vite', 'Bootstrap'],
    href: '/recipes/react-bootstrap',
  },
  {
    id: 12,
    category: '프로젝트 시작',
    title: 'FastAPI 부트스트랩',
    description: 'FastAPI 백엔드 기본 구조와 테스트 시작점 구성',
    prompt: 'FastAPI 백엔드 스타터를 만들어줘. /health, 설정 분리, pytest 스모크 테스트, 배포 전 체크리스트까지 포함해줘.',
    tags: ['FastAPI', 'Python', 'Backend'],
    href: '/recipes/fastapi-bootstrap',
  },
  {
    id: 13,
    category: '프로젝트 시작',
    title: 'Hono 부트스트랩',
    description: '경량 Hono API 서버를 빠르게 구성하는 레시피',
    prompt: 'Hono API 서버를 시작하려고 해. 최소 폴더 구조, /health + CRUD 라우트, 로깅/에러 미들웨어, 테스트 샘플을 만들어줘.',
    tags: ['Hono', 'TypeScript', 'API'],
    href: '/recipes/hono-bootstrap',
  },
  {
    id: 14,
    category: '개발',
    title: 'CRUD 엔드포인트 추가',
    description: '기존 서비스에 안정적으로 CRUD API를 추가',
    prompt: '기존 서비스에 [RESOURCE] CRUD 엔드포인트를 추가하고 싶어. DTO/검증/테스트/응답코드 규칙까지 포함한 구현안을 만들어줘.',
    tags: ['CRUD', 'API', 'Validation'],
    href: '/recipes/add-crud-endpoint',
  },
  {
    id: 15,
    category: '개발',
    title: '인증 추가 (세션/쿠키)',
    description: '쿠키 기반 인증과 CORS 설정을 함께 점검',
    prompt: '세션/쿠키 인증을 도입하려고 해. CORS와 SameSite/Secure 정책, 클라이언트 credentials 설정, 테스트 시나리오를 정리해줘.',
    tags: ['Auth', 'Cookie', 'CORS'],
    href: '/recipes/add-auth-cookie',
  },
  {
    id: 16,
    category: '개발',
    title: 'PR 품질 점검',
    description: '회귀 위험 중심으로 PR 리뷰 체크리스트 생성',
    prompt: '이 PR을 리뷰해줘. 기능 회귀 위험 Top5, 누락 테스트, 배포 영향, Go/No-Go 판단을 우선순위와 함께 정리해줘.',
    tags: ['PR Review', 'QA', 'Regression'],
    href: '/recipes/review-pr-quality',
  },
];

const categories = ['프로젝트 시작', '개발', '배포'];
---

<DocsLayout
  title="Recipes - AI 프롬프트 모음"
  description="AI 에이전트와 함께 사용할 수 있는 검증된 프롬프트 레시피"
  currentPath="/recipes"
>
  <div class="max-w-4xl mx-auto px-6 py-8">
    <nav class="flex items-center gap-2 text-sm text-text-secondary mb-6" aria-label="현재 위치">
      <a href="/" class="hover:text-white transition-colors">홈</a>
      <span>/</span>
      <span class="text-primary font-medium">Recipes</span>
    </nav>

    <header class="mb-8 pb-6 border-b border-border">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-accent-purple/10 text-accent-purple text-xs font-bold mb-4">
        Core Pack
      </div>
      <h1 class="text-3xl md:text-4xl font-black text-white mb-4">
        Agent Recipes
      </h1>
      <p class="text-text-secondary text-lg leading-relaxed">
        AI 에이전트와 함께 사용할 수 있는 검증된 프롬프트 레시피입니다.
        복사해서 바로 사용하세요.
      </p>
    </header>

    <section class="mb-10">
      <Callout client:load variant="tip" title="사용 방법">
        <ol class="list-decimal list-inside space-y-1 mt-2 text-sm">
          <li>원하는 레시피의 <strong class="text-white">복사</strong> 버튼을 클릭</li>
          <li>Antigravity, ChatGPT, Claude 등 AI 채팅에 붙여넣기</li>
          <li><code class="bg-surface px-1 rounded">[대괄호]</code> 부분을 실제 내용으로 교체</li>
        </ol>
      </Callout>
    </section>

    {categories.map((category) => (
      <section class="mb-12">
        <h2 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
          {category === '프로젝트 시작' && (
            <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-green-500/20 text-green-400">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
              </svg>
            </span>
          )}
          {category === '개발' && (
            <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
              </svg>
            </span>
          )}
          {category === '배포' && (
            <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-purple-500/20 text-purple-400">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
              </svg>
            </span>
          )}
          {category}
        </h2>

        <div class="grid gap-4">
          {recipes
            .filter((r) => r.category === category)
            .map((recipe) => (
              <div
                class="group p-5 bg-surface border border-border rounded-xl hover:border-primary/50 transition-all"
                data-recipe-id={recipe.id}
              >
                <div class="flex items-start justify-between gap-4 mb-3">
                  <div>
                    <h3 class="text-white font-bold mb-1">{recipe.title}</h3>
                    <p class="text-text-secondary text-sm">{recipe.description}</p>
                  </div>
                  <button
                    class="copy-btn shrink-0 flex items-center gap-1.5 px-3 py-1.5 bg-primary hover:bg-primary-hover text-background text-sm font-bold rounded-lg transition-all"
                    data-prompt={recipe.prompt}
                  >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                    </svg>
                    <span class="copy-text">복사</span>
                  </button>
                </div>

                <div class="bg-background/50 border border-border/50 rounded-lg p-3 mb-3">
                  <p class="text-slate-300 text-sm font-mono leading-relaxed">
                    "{recipe.prompt}"
                  </p>
                </div>

                <div class="flex flex-wrap gap-1.5">
                  {recipe.tags.map((tag) => (
                    <span class="px-2 py-0.5 bg-background rounded text-xs text-text-secondary">
                      {tag}
                    </span>
                  ))}
                </div>

                {recipe.href && (
                  <div class="mt-3">
                    <a
                      href={recipe.href}
                      class="inline-flex items-center gap-1.5 text-sm text-primary hover:text-primary/80 transition-colors no-underline"
                    >
                      상세 가이드 보기
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                      </svg>
                    </a>
                  </div>
                )}
              </div>
            ))}
        </div>
      </section>
    ))}

    <section class="mb-10">
      <Callout client:load variant="info" title="더 많은 레시피가 필요하신가요?">
        <p class="mt-2 text-sm">
          프로젝트에 필요한 프롬프트가 없다면,
          <a href="https://github.com/curogom/choorai/issues" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline">
            GitHub Issues
          </a>에서 요청해주세요.
        </p>
      </Callout>
    </section>

    <PageNavigation currentPath="/recipes" />
  </div>
</DocsLayout>

<script>
  document.querySelectorAll('.copy-btn').forEach((btn) => {
    btn.addEventListener('click', async () => {
      const prompt = btn.getAttribute('data-prompt');
      const copyText = btn.querySelector('.copy-text');
      const recipeId = btn.closest('[data-recipe-id]')?.getAttribute('data-recipe-id');

      try {
        await navigator.clipboard.writeText(prompt || '');
        window.chooraiTrack?.('copy_prompt', {
          source: 'recipes',
          locale: 'ko',
          recipe_id: recipeId || 'unknown',
        });
        if (copyText) {
          copyText.textContent = '복사됨!';
          setTimeout(() => {
            copyText.textContent = '복사';
          }, 2000);
        }
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    });
  });
</script>
